
# @alicloud/console-components-table

``@alicloud/console-components-table`` 是基于 ``Table`` 组件的增强实现，提供控制台标准化的数据列表

## 基本用法

[MDXInstruction:importDemo:BasicDemo](./stories/basic.tsx)

## APIs
> 继承 wind `Table` 的 API，除非特别说明
[MDXInstruction:renderInterface:IRcTableProps](./api-json/api.json)

## 卫星组件

可以将 ``@alicloud/console-components-table`` 看做一个包含了不同功能区的 ``Table``，不同的功能区中使用的组件可以看做是 ``Table`` 的卫星组件

```
|PrimaryOperation | Search |      SecondaryOperation|
----------------------------------------------------
|                     Table                         |
----------------------------------------------------
|Selection             |                 Pagination |
```

### Pagination

**分页器 (Pagination)** 是数据列表中常用的功能组件，根据UED规约，位于数据表格的右下角区域，在 ``@alicloud/console-components-table`` 中，可以通过 ``pagination`` 属性来定义分页器的属性和行为。开发者也可自行传入组件`<Table.Pagination {...props} />`或者函数`(tableProps) => (<Table.Pagination {...props} />)`，来进行定制。

#### 使用属性定义（推荐）

在 ``@alicloud/console-components-table`` 中，预设了符合UED规约的分页器组件，在绝大多数情况下，你只需要关心分页器的部分属性，比如：

- ``current`` 当前分页页码
- ``total`` 当前数据总条目数
- ``pageSize`` 每页数据条目数
- ``onChange`` 分页发生变化触发行为（通常是请求列表的数据并重绘）

预设的分页器使用了响应式设计：

- 在视口宽度小于 496px 时，显示 `mini` 的分页组件，强制不显示 pageSizeList 和跳转 input
- 在视口宽度在 497px - 790px 时，显示 `simple` 的分页组件，强制不显示 pageSizeList 和跳转 input
- 在视口宽度在 791px - 1128px 时，默认显示 `normal` 的分页组件，强制不显示 pageSizeList 和跳转 input
- 在视口宽度大于 1129px 时，默认显示 `normal` 的分页组件


通过`pagination.popupProps`可以配置popup组件的行为，比如改变分页组件选择列表的弹出方向：
```jsx
<Table
  dataSource={list}
  columns={columns}
  pagination={{
    popupProps: {
      align: "bl tl"
    }
  }}
/>
```
如下的Demo所示

[MDXInstruction:importDemo:WithPaginationProps](./stories/withPaginationProps.tsx)


#### 使用自定义组件

在大多数情况下，直接向 ``pagination`` 属性传入分页器的属性定义就可以完成标准场景的分页展示。如果你有一些情况下需要自定义这个区域的内容，也可以传入一个自定义组件来完成特定的业务需求

如下Demo所示

##### 示例：在分页器左侧添加一个功能按钮`Custom Button`

[MDXInstruction:importDemo:WithPaginationProps](./stories/withCustomPagination.tsx)

#### 使用自定义组件, 传入 (tableProps) => ReactNode

```jsx
<Table
  pagination={(tableProps) => (
    <Pagination {...paginationProps} />
  )}
/>
```

不再列举Demo，开发者可自行尝试


### Selection

**批量操作 (Selection)** 也是常用的功能组件，在 ``@alicloud/console-components-table`` 中，由于需要和 ``Table`` 内置的行选择进行交互，在底层使用了 ``Selection.Provider`` 重新封装了 ``Table`` 的行为，通过 ``Context API`` 对行选择的相关数据及行为进行传递交互，位于 ``Table`` 的左下角

#### 使用自定义组件

可以通过 ``selection`` 属性传入一个函数来进行定义，可以与`rowSelection`结合使用。

[MDXInstruction:importDemo:WithSelection](./stories/withSelection.tsx)

### Operation

位于 Table 左上角和右上角的操作区，没有任何预设组件和行为，通过 operation 来定义操作区的内容，也可`operation`传入一个对象，通过指定`primary`和`secondary`来定义左上角和右上角的内容。也可直接传入ReactNode只定义左上角行为

#### 使用自定义组件, 传入 ReactNode

##### 只定义左上角操作区
```jsx
<Table
  operation={
    <>
      <Button type="primary" onClick={onCreate}>Create New Record</Button>
      <Button onClick={onRefresh}>Refresh</Button>
    </>
  }
  {...tableProps}
/>
```

[MDXInstruction:importDemo:WithPrimaryOperation](./stories/withPrimaryOperation.tsx)

##### 同时定义右上角和左上角操作区
```jsx
<Table
  operation={{
    primary: (
      <>
        <Button type="primary" onClick={onCreate}>Create New Record</Button>
        <Button onClick={onRefresh}>Refresh</Button>
      </>
    ),
    secondary: (
      <Button onClick={onConfig}>
        <Icon type="cog" />
      </Button>			
    )
  }}
  {...tableProps}
/>
```

[MDXInstruction:importDemo:WithOperation](./stories/withOperation.tsx)


同样operation自定义组件时也可传入`(tableProps) => ReactNode`， 请参考`pagination`中的实现方式

### Search

**搜索区域 (Search)** 也会经常使用到，在 ``@alicloud/console-components-table`` 中预设了符合UED规约的搜索组件，在大多数场景下，你只需要关注一部分 ``Search`` 组件的属性。开发者也可自行传入组件`<Table.Search {...props} />`或者函数`(tableProps) => (<Table.Search {...props} />)`，来进行定制。

#### 使用属性定义（推荐）

search直接传入Search组件的props即可, 如下Demo所示。

```jsx
<Table
  search={{
    placeholder: '请输入name进行搜索',
    filterValue: 'en',
    filter: [
      {
        value: 'en',
        label: '英文',
      },
      {
        value: 'zh',
        label: '中文',
      },
    ],
    onSearch: handleSearch,
    onChange: handleSearch,
    ...seearchProps
  }}
/>

```

[MDXInstruction:importDemo:WithSearch](./stories/withSearch.tsx)

#### 使用自定义组件

在 search 右边添加一个自定义按钮（custom button）

```jsx
<Table
  search={
    <div>
      <Search
        placeholder="请输入name进行搜索"
        filterValue="en"
        filter={[
          {
            value: 'en',
            label: '英文',
          },
          {
            value: 'zh',
            label: '中文',
          },
        ]}
        onSearch={handleSearch}
        onChange={handleSearch}
      />
      <Button>Custom Button</Button>

    </div>
	}
/>
```
[MDXInstruction:importDemo:WithCustomSearch](./stories/withCustomSearch.tsx)

同样Search自定义组件时也可传入`(tableProps) => ReactNode`， 请参考`pagination`中的实现方式


## 在AppLayout中使用

[MDXInstruction:importDemo:WithLayout](./stories/withAppLayout.tsx)

## 指定affix-bar的渲染节点

通过`affixBarOverlayProps`来指定affix-bar的 `target`和`container`。可参考基础组件`overlay`
- target affix-bar定位的参照元素，最好是距离table最近的滚动祖先节点，否则可能会出现affix-bar位置错乱的问题。
- container 渲染组件的容器，是affix-bar的定位父级，需设置样式为`position: relative`。container节点的宽度决定了affix-bar的宽度，affix-bar理论上与container同宽。
```jsx
<SContainer ref={containerRef}>
  <SWrapper ref={targetRef}>
    <Table
      affixBarOverlayProps={{
        target: () => targetRef.current,
        container: () => containerRef.current,
      }}
    />
  </SWrapper>
</SContainer>
``` 

[MDXInstruction:importDemo:WithContainer](./stories/withContainer.tsx)